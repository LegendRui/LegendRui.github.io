---
title: Linux学习笔记
date: 2019-12-18 16:37:54
tags:
	- linux
---

#### 1 Linux系统目录
+ bin：存放二进制可执行文件
+ boot：存放开机启动程序
+ dev：存放设备文件
+ home：存放用户
+ etc：存放信息和系统配置文件
+ lib：库文件
+ root：管理员宿主目录
+ usr：用户资源管理目录

#### 2 Linux系统文件类型
* 普通文件（-）
* 目录文件（d）
* 字符设备文件（c）
* 块设备文件（b）
* 软连接（l）
* 管道文件（p）
* 套接字（s）
* 未知文件

#### 3 常用命令
+ ls：列出文件
+ cd：切换目录
+ which：查看命令路径
+ pwd：查看当前路径
+ mkdir：创建目录
+ rmdir：删除空目录
+ touch：创建文件
+ rm：删除文件（-r删除目录）

#### 4 文件命令
+ chmod: 更改文件权限
* 文字设定法：
* 操作对象可以是： u表示用户， g表示同组用户，o表示其他用户，a表示所有用户  
* 操作符号可以有： +添加权限，-取消权限，=赋予给定权限并取消其他所有权限
* 操作权限可以是： r读，w写，x执行   
``` 
chmod a+x file # 所有用户可执行
```
* 数字设定法：r是4，w是2，x是1   
```
chmod 764 file # 用户可读可写可执行，组用户可读可写，其他用户可读
```
+ chown：修改文件所属用户
```
sudo chmod user file
```

+ find：查找文件
* -type：按文件类型查找
* -name：按文件名查找
* -maxdepth：指定查找深度，应作为第一个参数出现
* -size：指定大小
```
find ./ -type "l"               # 查找软连接
find ./ -name '*.jpg'           # 查找当前目录及子目录下的jpg文件
find ./ -maxdepth 1 '*.jpg'     # 查找当前目录下的jpg文件
find ./ -size +200k -size -2M   # 查找200k~2M的jpg文件，注意是小写的k，大写的M
```

+ grep命令：找文件内容
```
grep -r 'copy' ./ -n
ps aux | grep cupsd
```

#### 5 gcc编译
编译分为四个步骤：
##### 5.1 预处理
任务：展开头文件，宏替换，替换条件编译，删除注释、空行和空格。  
指令：`gcc -E file`。  
生成文件：file.i  

##### 5.2 编译
任务：检查语法规范。  
指令：`gcc -S file[.i]`。  
生成文件：file.s

##### 5.3 汇编
任务：将汇编指令翻译成机器指令。  
指令：`gcc -c file[.s]`。  
生成文件：file.o  

##### 5.4 链接
任务：数据段合并，地址回填。
指令：`gcc file[.o]`。
生成文件：file.out

##### 5.5 其他常用参数
+ -I：指定头文件所在目录位置。
+ -g：添加调试语句，以便使用gdb调试
+ -Wall：显示所有警告信息
+ -D：向程序动态注册宏定义

#### 6 静态库制作及使用
##### 6.1 将.c生成.o文件  
命令：`gcc -c a.c -o a.o`

##### 6.2 使用ar工具制作静态库
命令：`ar rcs lib[库名].a a.o`

##### 6.3 制作静态库的头文件

##### 6.4 编辑静态库到可执行文件
命令：`gcc test.c lib[库名].a -o test`

#### 7 动态库的制作及使用
##### 7.1 将.c生成与位置无关的.o代码
```
gcc -c file.c -o file.o -fPIC
```

##### 7.2 制作动态库
```
gcc -shared -o lib[库名].so file.o
```

##### 7.3 编译时指定动态库
```
gcc test.c -o test -l [库名] -L [库路径]
```

##### 7.4 配置动态链接库的路径
+ 直接在终端执行`export LD_LIBRARY_PATH=[库路径]`
+ 修改终端配置文件
    * 在终端配置文件.bashrc下添加`export LD_LIBRARY_PATH=[库路径]`
    * 使配置文件生效： `. .bashrc` / `source .bashrc`  / 重启一个终端
+ 拷贝库到系统库路径`/lib`下
+ 配置链接器
    * 在链接器配置文件中添加动态链接库的绝对路径
    * 使配置文件生效：`sudo ldconfig -v`

#### 8 dentry与inode
**dentry（目录项）：**结构体，存储的时文件名与inode。
**inode：**结构体，存储的是文件的属性信息，以及文件在磁盘上的存储位置。